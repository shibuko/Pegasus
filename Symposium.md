# 1. Approach & Consistency
## PEGASUS の目的
### 責任範囲
* ドライバー（L1~L2）
  * 事故になりうるシナリオはドライバーが判断
  * 支援システムはあくまでドライバーのサポート
* 機械（L3~L5）
  * 事故になりうるシナリオは機械が判断
  * 機械による運転の質は人間の運転能力と比較される
  * 非常に複雑で様々に起こりうるシナリオに対応する妥当性確認プロセスが必要
  * 既存の方法で妥当性確認をおこなうことは実質的に非現実的
### PEGASUS の成果物：自動化に対する標準
* シミュレーション、試験設備、および実環境において自動運転車両のテストと試験をおこなうさいの標準的手続きの定義
* 自動運転の安全保護にむけた、連続かつ柔軟性のあるツールチェーンの開発。
* 開発初期段階のプロセスにおける各種テストの統合
* OEM 間で自動運転機能に対する安全保護手法を創出
## 自動運転機能の安全保護
高度な自動運転機能を試験するために、一般に受容される単一のアプローチをどのように作り上げていくか？
PEGASUS の目的は高度な自動運転機能の安全保護に対する手法を開発することであり、これは今後の自動運転の開発にとっての青写真となる。
PEGASUS 内の各種のサブプロジェクトとそれらのワークパッケージはそれぞれ密に繋がっているために、次に挙げる全体を見通した手法の開発が必要である：
* 各種法律や標準といった知見に基づいて、要求が定義されている
* データや知見から系統立ててシナリオを導出する
* テストインスタンスに対して、共通データベースの中でデータが処理・準備される
* HAF の安全性に関する記述はテスト結果と安全性論証に基づいていること

# 2. V-Model & Process Analysis
## 既存のプロセスを自動運転の観点から分析する
どこのステップで既存の開発と安全プロセスを拡張して自動運転機能の開発と安全保護ができるようにする必要があるか。
* V モデルは、もともとはソフトウェア開発から生まれた一つのプロセスモデルで、アビオニクスおよび自動車業界といった複雑かつセーフティクリティカルなシステム開発で使われてきた。
## ISO 26262
* ISO 26262 は、乗用車における電気電子システムの安全保護のための標準。
* V モデルに基づいて、262626 では電気電子システムの安全性を証明するためにプロセスを定義する。
* このプロセスは、いままでもそしていまなお、純粋に人間のドライバーだけが運転する車両と先進運転支援システム（ADAS）を搭載した車両のいずれにもうまく適用されている。
## プロセス拡張
自動運転機能の導入に伴う新たな課題と、これがもたらす開発プロセスと安全保護プロセスの拡張：
* 自動車以外の交通参加者との相互作用（混合交通）
* ドライバーと機械との権限委譲の状況
* 極めて複雑かつほぼ予測不可能な環境での運用（オープンワールド）
* フォールバックのレベルとしてのドライバーの不在（フェールセーフに代わるフェール運用）
* 製品のライフサイクルにおいて、セーフティクリティカルな機能要求が変更されること。たとえば、機能範囲の拡大および運用環境。
* ソフトウェアモジュールにおける機械学習技術の積極的活用。

# 3. The highway-Chauffeur

## 目的
* 高速道路での運転代替（ショーファー）、つまり条件付き自動運転機能の一例（SAE レベル3）
* 標準シナリオ、安全を左右するシナリオ、および自動化によるリスクがシナリオデータベースを充実させるための基礎
## 自動化レベル：3（条件付き自動化）
* 運転タスク
  * システムが縦方向と横方向の運転タスクを担う。
* 監視タスク
  * ドライバーが常にシステムを監視する必要はない。運転以外のタスクは限定されるが可能。
* ユースケースの限界
  * システムが自身の限界を認識するが、いかなる状況からもリスクが最小の状態にできるわけではない。であるから、十分な時間的余裕をもって、システムはドライバーに運転に戻るように指示する。ドライバーが状況に対応できないことがあれば、自動運転車両は緊急事態にうまく（人間よりはマシに）対処する。
* ドライバーの役割
  * いつ自動運転システムをにするのが合理的かを判断する。
  * システムから指示されたときに運転タスクを引き継ぐ（十分な時間的余裕あり）。
  * 自動運転システムを解除できる。
* 自動運転機能の役割
  * 動作中は、運転環境を把握する。
  * 予め想定されたユースケースのような条件下においてのみシステムの動作を許可する。
  * 動作中は、縦方向と横方向の運転タスクを実行する。
  * 十分な時間的余裕をもってドライバーに運転の引き継ぎを指示する場合に限り、自らの動作を終了する。
## 基本機能
* 安定化
  * 速度維持
  * 車間距離維持
  * 車線維持
* 経路案内
  * 速度・車間距離適応
    * 関連ある・不適切な速度制限
    * コーナリング速度
    * 追従走行時の車両の向き
    * 渋滞追従
    * 合流
  * 車線変更
    * 隣の車線があるか
    * 隣の車線に走行車両がいるか
    * 安全かつ快適な車線変更
    * 車線変更の終わり
    * 右方優先義務（右側通行）
    * 路肩との距離
  * 追い越し
    * 関連ある・不適切な追い越し禁止
    * 右側追い越し禁止（右側通行）
  * 危険状況（渋滞、角、…）
## 運転資格と運転機能の使用
* 運転資格
  * 運転免許
  * 運転能力
  * シートベルト着用
  * 運転タスク引き継ぎに関する一般能力
* 運転機能の使用に関する要求
  * 高速道路または高速道路に準ずる道路での運転（ドイツ基準による）
  * 速度制限を超えて運転してはならない
  * 後退してはならない
  * 工事中の道を運転してはならない
  * 状況のよくない道または悪天候下で運転してはならない（たとえば、滑りやすい道）
  * センサの視界状況が悪い中で運転してはならない
  * センサを覆ったまま運転してはならない
  * ネットワーク接続を切ったまま運転してはならない
  * 適切な車両状態にないまま運転してはならない（たとえば、ブレーキのオーバーヒート、燃料が残りわずか）
  * 関連するシステムが失陥したまま運転してはならない
  * ドライバーが乗っていない状態で運転してはならない（たとえば、シートベルトを着用している、運転席に座っている）
  * ドアを開けたまま運転してはならない
  * トレーラーを引いて運転してはならない
## システム境界に関するまとめ
* 高速道路でのみ機能を有効にする
* ドライバーに運転を引き継ぐときには十分な時間的余裕があること
  * 高速道路の終わり
  * ジャンクション
  * インターチェンジ
  * 道路工事箇所
  * 料金所や国境
* システム境界外で機能を有効にしないこと（たとえば、高速道路の加速レーン）
* 最高速度は推奨速度であること。それ以上の速度で機能を有効にすることはできな
* トレーラーの牽引禁止
* 混雑時には車線変更禁止
* 後退禁止
* 車両の異常時にはドライバーが運転を引き継ぐ（システムによる引き継ぎは禁止）
* 以下では機能を有効にすることを禁ずる：
  * 車両が適切な状態にないとき
  * 道路状況が悪いとき
  * 悪天候のとき（システム引き継ぎと減速）
  * センサの視界が悪いとき
  * 逆走
  * ドアが空いているとき
  * ドライバーが乗車していないとき
  * センサがカバーされているとき
  * 長時間にわたり道路マップまたは GNSS データを受信できないとき
# 4. Scenario Description
## シナリオがシナリオとは限らない
シナリオの中身とは何か、どのように記述するか？
開発プロセスでどのようにシナリオを利用していけばよいか？
PEGASUS のテストコンセプトでは、シナリオは欠かせない要素の一つ。
「シナリオ」という言葉は、開発プロセスのフェーズによって内容も表現も違う。
シナリオの具体化とテストケース生成には、物理的な状態空間におけるパラメータ空間を使った表現が求められる。
テストケースの実行とアセスメントには、共通のデータフォーマットで書かれた、厳格に定義されたシナリオが必要。
3つの抽象度のレベルに分解する：
* 機能
* 論理
* 具象
5層モデルに基づいた構造。
## 開発プロセスにおけるシナリオの活用
どのプロセス段階でシナリオを使えるか？
プロセスにおいてどの要求が求められるか？
Vモデルにもとづく開発プロセス（たとえば、ISO 26262）では、最新の自動運転機能の開発を定義している。
シナリオはいくつものプロセスにおいて活用できる。異なるフェーズで使うことで、シナリオの表現方法に関して一貫性のない要求が求められる。
* コンセプトフェーズ
  * 自然言語でシナリオを表現すること
  * 専門家がシナリオを読んで理解できること
  * 分解できるところまで、使われる言葉を一貫して定義すること
* システム開発
  * システム状態に対して範囲のあるパラメータでシナリオを定義すること
  * 範囲のあるパラメータに対して形式的表現を使ってシナリオをまとめること（データフォーマット）
* テストと妥当性確認
  * テスト手法およびテストツール上でまとめ上げて実行できるだけの詳細さでシナリオを記述すること
  * 各シナリオを区別して記述し、解釈の可能性を残すこと（再現性）
  * コンピュータアプリケーションで効率的に読めるかたちのシナリオであること

# 5. Critical Scenarios for Human Drivers
事故につながる危険性のあるシナリオにおける人間の運転パフォーマンス。
安全性を左右するシナリオにおいて、ドライバーはどのようにしてうまく運転しているのか？

## ドライバーの運転パフォーマンスと PEGASUS の関連
* ドライバーの運転パフォーマンスというものを高度自動運転車両のベンチマークと捉えることができる。ドライバーはうまく運転しているように見え、事故のリスクは低い。ここでは、ドライバーにとって安全性に関わるシナリオを特定し、ドライバーの運転パフォーマンスをアセスメントしたい。
## PEGASUS では人間のドライバーの運転パフォーマンスをどのように定義しているか？
* ドライバーの運転パフォーマンスとは、ドライバー自身の運転能力の現れであり、運転シナリオに依存したタスクである。
* 安全性に関わるシナリオでは、衝突を避けるために、ドライバーが対処運転をしなければならない（すなわち、アクセル、ブレーキ、ステアリング操作）。ドライバーの運転は主にスキルをもとにしたものであり、その対処行動がシナリオの安全性に直接影響を与えることになる。
## PEGASUS における、ドライバーの運転パフォーマンスの観測と分析
図2：
NDS/FOT シナリオでは、ドライバーがコントロールできる、またはコントロールできなくなっても事故は起こらない（左）。
NDS/FOT では、危険性が非常に高いシナリオは稀である。
ドライビングシミュレータを使って、危険性が非常に高いシナリオで、ドライバーの運転パフォーマンスを研究し、その閾値を見つけようとしている（中央）。
衝突データには衝突に至ったシナリオに関する情報が含まれている。ここでは、ドライバーの運転パフォーマンスに影響しているのは主に、注意散漫のような、いわゆるヒューマン・ファクターである。
## 事故につながる割込み操作
割込み操作に対するドライバーの反応の分析。
Fiels Operation Tests（FOT）と Naturalistic Driving Studies（NDS）の協力を得て、事故につながる状況、これらの性質、およびドライバーのふるまいを分析する。
シナリオと操作（割込み、高速道路の出入口、突然の渋滞に対する反応）の違いによる反応を特定し、計測データに基づいてそれらの性質・指標を記述する。
* ドライバーの運転パフォーマンスと突然の割込み操作（これにより、ドライバーは衝突予測時間（TTC）8秒以内に反応しなければならない）による事故の危険性との関係、最大限速度と割込み操作のによる事故の危険性の関係がわかった。より危険性の高いシナリオ（つまり、自車両と割込み車両との TTC が短い）では、ドライバーはより早くより強いブレーキ操作（図1の左と中央）をおこなうということである。最も危険な割込みのケースは、TTC 1.7 秒のときである。
* ACC のセンサが割込み操作を検知するより先に、ドライバーの反応を観測することができ、これは結果的に負の反応時間となる。ブレーキ操作の強さとの関係は、図1中央からもよくわかる。
* さらに、シナリオの危険性が高いほど（TTC が短い）、ドライバーがブレーキペダルを踏む時間が長いが（図1右）、これにはドライバーによる差が大きくみられる。
## German In-Depth Accident Study (GIDAS)
GIDAS に関して、場所の影響とは何か？
「ヒューマンファクター」による事故はどのくらい起きているか？
* GIDAS
  * 29,400 件の事故
  * 55,700 人の交通参加者
  * 73,000 人の個人
  * 33,000 台の乗用車（トレーラを含まない）
  * そのうち、2,600 件が高速道路、またはこれに準ずる道路で発生している。
* 領域の制約（自動車専用道でトレーラなし）に加えて、5つの主なフィルターを適用する。
  * 1. ドライバーが反応する直前の速度は 130 km/h 以下だった
  * 2. 車線マーカーの状態は良かった
  * 3. 路面には事故につながるような穴はなかった
  * 4. 車両は合流車線を走行していなかった
  * 5. 天候の影響のようなさらなる制約
* さらなる事故調査を計画している
  * クラスタリングの自動化と論理シナリオへの割当て
  * 自己シーンの中で「ヒューマンファクター」を特定し、どの事故が「ヒューマンファクター」が原因で起こったかを特定する。これにより、人間の能力に関連している事故、人間の能力が影響しうる事故を見つけることができる。

# 6. Critical Scenarios for and by the HAD (L3)
## 自動化によって従来型の事故原因を回避する試み  
自動化によって、新たな事故原因が生まれることもあるが、防ぐことのできる事故原因の方が多い。
## 事故回避
* 現在では、ヒューマンファクターが主な原因となって事故が発生している（車両原因との対比、車の性能が上がってきている）
* 事故データベースによって、事故原因と事故記録に関して分かることが多くなってきた
* 自動運転車の普及によって、事故の件数は減るものとみられる。

ドライバーが事故を引き起こすような状況であっても、自動化によって避けることができる

## 状況変化
* システムの制約があっても、高度自動運転によって道路の安全に貢献できる
* しかし、自動運転車両であっても事故を起こしてしまう状況もまた存在する
* 特に、ドライバーにとって簡単に対処できるような状況では、市場における受容性の欠如が問題となりそうだ

自動運転車両が事故を起こす状況であっても、ドライバーなら避けられることもある

## 自動運転に関する未解決リスク
* どんなリスクが存在するか？どのような状況でリスクが発生するか？
* どれだけのリスクが特定され定量化されているか？
* PEGASUS を用いても、自動運転のリスクはどのようにして紛れ込まれてしまうか？

## 自動運転によるリスクの特定と定量化
自動運転機能によって引き起こされる新たな事故原因の種類とは？どのようなシナリオでそれらが生じるのか？
* class(1): 環境が自動運転システムに与える影響
* class(2): 自動運転システムが環境に与える影響
* class(3): 環境がドライバーに与える影響、およびドライバーと自動運転システムの相互作用

## (1) 環境が自動運転システムに与える影響
* 環境認知を誤る
* 状況解釈を誤る
* 周囲の交通参加者の経路予測を誤る

## (2) 自動運転システムが周囲の交通参加者に与える影響
* 自動運転システムのふるまいの解釈を誤る
* 自動運転システムが予期できない反応
* 社会的受容性
* 交通流に対する影響

## (3) ドライバーと自動運転システム+影響を受ける環境との相互作用
* モード混乱（mode confusion）
* 確信度の喪失
* 機能の誤用
* ドライバーの追い越しの影響
* 要求の導出（人間機械系（human-machine-system））

パラメータ幅を持ったシナリオと上記の影響を考慮したリスクを足し合わせてテスト仕様データベース（test specification database）に保存する

# 7. Social Acceptance for HAD (L3)
## 高度自動運転にはユーザ、社会、および周囲の交通参加者による受容性が欠かせない
どのリスクが受容可能で、高速道路での運転にとって結果的に必要となる要求とは何か？
* リスク受容性に関連する基準は、
  * 選択の自由
  * 可制御性
  * 個人の利益
* 個人の要求と集団の要求とは分けて扱うべきである
* すでに受容されてきたリスク指標の利用
  * ### GAMAB 原則（少なくとも実質的に世界で実施されている）
  * アウトバーンにおいて今日のリスクから導かれるもの
  * 深刻度の異なる事故の集団的リスクを記述すること
  
  * ### MEM（minimum endogenous mortality、内在的死亡率を最小にする考え方）
  * ドイツでの MEM は、1年間で一人あたり約6x10^-5（出典: Sterbetafel, Statistisches Bundesamt）
  * 個人が一つ以上のリスクに曝されているように、新たな技術によって、MEM / 20 以下の値を超えるべきではない（出典: EN 50126）
  * 許容可能な個人の死亡リスクは、1年間で一人あたり 3x10^-6 以下
  
## 高度自動運転の社会受容性
どのリスクが「社会的に」受容可能で、高速道路での運転にとって結果的に必要となる要求とは何か？
* 道路上のリスクは現在では減少しつつあるが、どの減少傾向は過去10年ほどで小さくなってきている
  * テーマ: 高度自動運転がなければ、この傾向はより小さくなり、やがて下げ止まる
  * 長期: 高度自動運転のリスクを今日のリスクまで下げなければならず、減少の長期的傾向が続いていることを確認する
* この他にも道路上の安全に関して考慮すべきものがある
  * ユーザと周囲の交通参加者に対するリスク
  * 事故分布の深刻度の変化、特に死亡事故または負傷事故に関するもの
  * 高度自動運転の搭載率と運転履歴
* 高度自動運転の導入初期において、社会に知安する影響は限定的。その理由は、リスクについて想定される変化というものが少数の車両からのみの影響しかないからである
  * 搭載率が高くなると要求も増加する
* 他の技術のリスク、たとえば他の交通システムのそれ、と比較することで、技術導入に対する受容可能なリスクの定義がしやすくなる

## ユーザに対する高度自動運転の受容性
「ユーザにとって」どのリスクが受容可能で、高速道路での運転にとって結果的に必要となる要求とは何か？
* ユーザによって受容可能なリスクは異なる。技術から直接恩恵を受けることになるから。
* ビジネスに関する内容説明は可能になりそうだ。したがって、1年間に一人あたり1x10^-5の死亡事故のリスクが示されている。
* 他の技術のリスク、たとえば他の交通システムのそれ、または携帯電話といった高い恩恵を得られると見られている他の技術と比較することで、技術導入フェーズに対する受容可能なリスクの定義がしやすくなる

## 周囲の交通参加者に対する高度自動運転の受容性
「周囲の交通参加者にとって」どのリスクが受容可能で、高速道路での運転にとって結果的に必要となる要求とは何か？
* 高度自動運転車両との遭遇とは意図せず新技術を目にする機会であり、個人のメリットとは無関係だ。
  * Fritzsche によれば、 1年間に一人あたり 1x10^-6 の死亡リスクであれば受容できる。
  * これにより新たなリスクが生まれる。高度自動運転なしでは存在しないリスクである。
* 実際のリスクとは、個別の高度自動運転機能のリスクによるものだけではなく、搭載率にも影響される
  * 搭載率が下がると、周囲の交通参加者に対するリスクは低くなる

## 今日における他のリスクと比較して、道路上のリスクとは何か？
無作為に選ばれたドイツ人が死亡するリスクを高い順に並べると、
* 寿命
* がん
* 1年以内の心臓疾患
* 1年以内のがん
* 「1年以内の交通事故」
* 1年以内に魚の骨で窒息
* 1年以内に浴室で溺死
* いつか雷に打たれる
* 上空から飛行機が墜落してくる
* 原子力発電所のメルトダウン

# 8. Challenges of a Scenario-Based Approach
## テスト手法からセーフティケースまで
シナリオベースで得られる証拠はどれだけ信頼できるのか、これらの証拠は安全性論証を補強するか？

PEGASUS では、グレーボックス型のテスト手法を提供している。これは得られたシーンとシステムに関する知見を組み合わせて作られたもので、高度自動運転機能が少なくともドライバーと同程度であるという仮説の証拠を提示することを目的とする。これを証明するために、PEGASUS では、テストケースの導出、作成、および評価法を示している。本手法によって安全性を実証できるというところまで話を拡張するには、次に挙げる「評価基準」の意味で精査する必要がある。
* 前提範囲（coverage assumption） - 設計意図の観点から前提条件の十分性を述べる
* 事実に基づかない証拠 - 補強証拠を伴わない論証をいう
* 使われない証拠 - セーフティケースには使われない証拠をいう

### 1. 情報ベース
* 安全性を実証する目的で、参照データを提示するために使う、
* ただし、考慮しているシーンによる制約のもとで前提範囲を伴う。参照データに代表性がない、あるいは システムに対する理解が不完全な場合、そこには事実に基づかない証拠が入り込む。  

既知の関係性に対してのみ証拠が提示されることから、前提範囲に関する制約条件には「一般課題（general challenge）」がある。似たようなことに、「ブラックボックステスト」から作り出された証拠でさえ、運転範囲およびその代表性に依存している。代表性を無視すると、「ブラックボックステスト」とシナリオベーステストの両方の信頼性に影響を及ぼす。これは、安全性が証明されているが実証されていないということであり、事実に基づかない証拠から安全性が帰結されている。  

システムへの理解、代表的「ブラックボックステスト」を考慮することで、個々のシナリオは本質的にはテストの部分であるが、シナリオベースの方法ではシナリオは追加で生成されたものに他ならない、という利点がある。  

### 2. オントロジー（ontology；シナリオの存在について）
* 観測した交通シーンにある関係性を特定するために使う。これによりシナリオをさらに生成することができる、
* 前提範囲の拡大を伴うが、生成されたシナリオに関連性がない場合、事実に基づかない証拠である。  

新しいシナリオ/追加のシナリオ生成にオントロジーを使う場合の課題は、代表性を持つように観測済みのシーンから関係性を抽出することにある。あいにく、シナリオが起こらない限り、その代表性なるものは通常分からない。このことに対処しないでおけば、事実に基づかない証拠を含むことになる。その理由は、安全性が実証されているが、これによってセーフティケースにどのように役立つかということは不明なままである、ということによる。これを回避するために、可能な限りシステムの知見を使って、生成シナリオの関連性を論証することを提案する。論証となるものが見からない場合、生成シナリオをセーフティケースに使うことは許されない。

### 3. 危険性（criticality）
* 事故の可能性があるシナリオの特定に使う、
* 偽陽性（false positive）の存在下で事実に基づかない証拠、あるいは偽陽性の場合の不採用証拠を含む。  

危険性を決定する場合の課題は、偽陽性と偽陰性（false negative）を天秤にかけることにあり、これにより事実に基づかない証拠と不採用証拠のそれぞれを生み出してしまう。偽陽性の場合、制約のあるシーンまたは危険性のないシーンであっても危険があるとみなされ、実証済みの安全性についての誤謬につながる。対照的に、証拠が不採用のままということは、危険性のあるシーンが危険ではないとみなされ、テストの際に除外されたということである。このトレードオフをみると、なぜそのシーンをテストする必要があるかということの証明には危険性が必須である、ということに注意する必要がある。

### 4. 関連性（association）
* 観測シーンを論理シナリオに分割するのに使う
* 論理シナリオが観測シーンの動的ふるまいの厳密さを欠く（relax）と、事実に基づかない証拠を含み、この結果、安全性は証明されているが補強証拠が提示されていない。  

関連性には観測シーンの分割に関する課題があり、結果的に作られる論理シナリオが交通における観測シーンの動的ふるまいを単純化したものではなくなってしまう。シーンの単純化の観点から、分割対象の観測シーンと比較して、論理シナリオから導かれるテストはパスしやすいものになる。これからわかることは、安全性は証明されているが、厳密な論証に対する証拠は示されていないということであり、こういった論証にはセーフティケースに対して事実に基づかない証拠が含まれている。対照的に、変化を与えることなく観測シーンをテストすることで、「ブラックボックステスト」ではこの問題に悩まされることはない。

### 5. 関係（relation）
* シナリオに関する機能不全に対するトリガーを表現するのに使う
* 全く同じシナリオに対する複数の証拠が示された場合、事実に基づかない証拠を含む。これは、自動化リスクに関する情報を使っても使わなくてもシナリオをテストしている、という事実によるものである。  

関係には、システム知見をシナリオに書き替えるするという課題がある。これは、両者の間にある意味的なギャップと、自動化リスクを引き起こすのに必要となる文脈情報の不足の両方またはそのいずれかによるものと考えられる。この課題を放っておけば、対象システムが厳密な条件の元でテストされないがために、事実に基づかない証拠を生み出すことになる。対照的に、自動化リスクに対するトリガーが本質的に観測シーンの一部分になっているため、「ブラックボックステスト」ではこの課題に悩まされることはない。しかし、「ブラックボックスアプローチ」では、自動化リスクを扱う目的で「テスト対象のシステム」の能力をテストすることに使用することはできるが、過剰なテストによって必要なトリガーが稀に発生することを保証するものではない。この観点から、シナリオベースのテスト手法には、それぞれのトリガーを特定すれば、システム知見を再現できるかたちでテストすることができるという利点がある。

### 6. バリエーション
* パラメータを変化させて、「テスト対象システム」の安定性をテストするために使う
* 前提範囲の増加、あるいは関連のあるシナリオまたは関連のないシナリオのいずれにしても事実に基づかない証拠を含む。  

バリエーションには、結果的に作られるシナリオが関連しているというようなテスト仕様に対して変更を与えるという課題がある。関連する新しいシナリオが示されたケースでは、前提範囲が増えることになる。しかし、関連があると仮定されるもののこれが存在しないならば、事実に基づかない証拠となることは間違いない。これとは対照的に、システム知見を使って、バリエーションの結果としてのシナリオの代表性を証明することを提案する。安全性を論証できなくても、それでもなお、さまざまなシナリオについてテストすることができるが、それは「テスト対象システム」の安定性を確認するためだけであり、シナリオの代表性が証明されない限り、セーフティケースにはつながらない。

# 9. Functional Decomposition
高度自動運転の承認活動を削減するためのアプローチ
※functional: 基本、定性、本旨、本性
 
* 統計的に「高速道路ショーファー」の承認を得るためには何十億kmものテスト走行が要求される。しかしこれを実現することはできない。
* シナリオベースのアプローチによってテスト活動を削減することができる、しかしながら、異なったシナリオを使ってすべての機能レイヤにおける運転機能を証明していることになる。加えて、制約条件について考えられる組み合わせの数と初期状態がテストケースの数を膨大なものにしている。
* 高度自動運転機能に関する機能分解とそれに続く特定のケースにおける関連シナリオの分割（一つあるいは複数の機能レイヤをテストする）では以下が期待できる
  * テスト活動の削減
  * 的を絞ったテスト費用（XiL、テストコース）の使用
  * 実行レイヤを飛ばすことによるリスクの低減（オープンループテスト）

## 機能分解を実装するための課題
* 独立した分解レイヤとアクセス可能なインタフェースの定義
* 特定のテストに対するOK/NGの基準の定義
* 機能分解の完了承認

## 関連シナリオ（機能）
* 関連する機能シナリオをSP1で特定してデータベースに保存する。
* FOTデータや事故データベースにある適切な指標を使うことで関連シナリオを解析的に特定することができる。または、オントロジーに基づいて合成することができる。
* シナリオを機能的（数値を伴わずに言語のみによる記述；基本シナリオ）に、論理的（数値範囲の割り当て；論理シナリオ）に、または具体的（固定値の割り当て；具体的シナリオ）に記述することができる。
* 図の例は、実際の事故から作成した基本シナリオで、テスラ モデルSが路肩に停車していたバンに追突する（2016年スイス）。
* NO. 4-6と11-12を参照のこと。

## 概要マトリクス
概要マトリクスを作って、不合格基準・要求を機能レイヤと関連シナリオに割り当てる。

## FTAを使った不合格基準の定義と割当て
* 関連シナリオの全てに対して、FTAを使って機能的不合格基準を特定する。不合格基準を概要マトリクスの中で割り当てる。
* 関連シナリオから展開することができる起こりうる事故をトップ事象にする。最下位の事象が不合格基準である。
* 基本シナリオのレベルでこのステップの記述をする（No.4、11を参照）。

## 不合格基準の消去と選択
* 重複する不合格基準・要求を消去する。
* 不合格基準・要求のうち部分集合または互いに交差する集合になっているものを選択する。
* 基本シナリオレベルでこれを始めにおこない、続いて論理・具体的シナリオレベルでおこなう。

## 適切なテスト環境の選択と残りの不合格基準に対するテストケースの定義
* 残りの不合格基準に対して、適切なテスト環境・手法（XIL、テストコース試験）をそれぞれの有効性に応じて選択肢する。
* 不合格基準を満たさないことを証明するために、特定のテストケースを定義する。
* 不合格基準が完全に定義されている場合、これを承認安全評価に使用する。
* No. 10-21を参照のこと。

# 10. Test Concept and Test Case Allocation

## 論理シナリオからテストケースへ
最終的なテストコンセプト、テストケースの割当て方法、およびテスト手順の実行方法について

* テストコンセプトの作成:  
テスト対象、テストレベル、テストプラットフォームの設定、および各テストレベルに対してテストケースを割り当てる

* テストケース割当て:  
一般的なテストコンセプトに基づいて、ユースケースに費やしているテストレベルのシミュレーション/テストコース/実路テストに対して割当てを実施する。

* シミュレーション対象のテストケースのバリエーション  
確率的パラメータのバリエーションとテスト自動化のそれぞれによって発生する。テストコース走行でのバリエーションは人手による選択、あるいはシミュレーションによる関連シナリオの特定によって起こる

* 結果: 具体的テストケース  
異なるテスト環境に対するもの。合格/不合格の基準を含む

* テスト結果:  
合格/不合格の基準を使って、シミュレーション、テストコース、および実路で実施した具体的シナリオを評価する

論理テストケース空間から始めて、テストコースとテストレベルを決定する。
これにより、論理テストケースに含まれる「すべての」論理シナリオをシミュレーションでテストする。論理シナリオのパラメータにおける自動化/確率的バリエーションによって、具体的テストケースを作る。合格/不合格基準に沿ってこれらのテストケースを評価する。

危険なケース（つまり、合格基準を満足しなかった、あるいはわずかに届かなかった）を実車でテストコースを使って評価する。さらに、人手で選んだ具体的テストケースをテストケースで評価することもできる（つまり、事故のシナリオ、点数付けテスト、あるいは認証テスト）。




# 11. Scenario Formats
## シナリオの技術的表現
どのようにしてシナリオを技術的に表現するか？そして抽象度の各層における要求をみたしていくか？  
シナリオに対して複数の抽象度があることから、その表現に関する要求とシナリオのデータフォーマットを明確に区別する必要がある。同様に、データフォーマット間で効率的に変換する方法を確立する必要もある。
* 基本シナリオ（functional scenario）:  
基本シナリオとは、専門家による解析手法のために基礎となるもの。  
基本シナリオの表現に対して、言語記述構造が開発されてきた。この構造によって、シナリオの段階的定義が可能になる。
* 論理シナリオ（logical scenario）:  
論理シナリオを使ってパラメータ空間を定義し、テスト実施とテストケース生成に必要な情報を作り出す。  
三つのデータフォーマットによって、論理シナリオを表現する。道路については、高速道路建設に関するドイツ標準を参照しながら、記述している。交通参加者については、OpenSCENARIO を通してモデル化している。  
二つのデータファイルをパラメータレンジ記述と対象とするパラメータの確率分布に拡張する。
* 具体的シナリオ（concrete scenario）:  
具体的シナリオをシミュレーションの入力データとして使用する。  
具体的シナリオは、準標準の OpenDRIVE と OpenSCENARIO を使って表現される。

論理シナリオテストケース生成の基礎となる。パラメータの組合せと同様に、適切なパラメータ設定のために、パラメータ空間を詳細に記述する必要がある。  
詳細な記述のためには、パラメータ空間に以下の情報が含まれていること：
* パラメータ:  
複数のシナリオパラメータとその値の幅を記述する。
* 確率分布:  
各パラメータに対して、実際の状況の中で発生する確率分布を特定することも可能。
* 数値的関係: 
相反する値の組合せを排除するために、数値的関係（たとえば、不等式を使ったもの）をモデル化することも可能。

* OpenDRIVE:  
XML によるオープンファイルフォーマット OpenDRIVE を使って、静止物体を含んだ複雑な道路ネットワークを表現し、詳細な地理情報と道路のトポロジを定義する。  
OpenDRIVE は特定業界と研究分野では一般的で、複数のシミュレーションツールがサポートしている。3D エクスポートによって、いろいろな使い方がある。たとえば、ドライビングシミュレータにも使われている。高速道路や複雑な都市環境といった幅広い道路が利用可能。
* 道路の簡略記述:  
道路を簡略的に記述することで、道路のモデル化に関する手間と複雑さを削減し、道路の部分部分の表現をシンプルにしてテスト実行に力を入れることができる。  
各種マクロと数値処理を使って、道路の簡略記述を OpenDRIVE に変換する。  
これにより、道路パーツ生成を高速化でき、特性値を変更するだけでテストケースを実行するための道路バリエーションを作り出すことができる。

* OpenSCENARIO:  
ツールに依存しないオープンなファイルフォーマット OpenSCENARIO を使って、一つのシミュレーション中に登場する複数オブジェクトに関する時変なシナリオの仕様を定義する。  
交通参加者、インフラ、および周辺の動くオブジェクトの状態変化は、「条件」にトリガーされる「アクション」として記述される。  
OpenSCENARIO 言語の汎用性によって、高速道路から都市部におよぶ複雑な交通状況を記述可能。

# 12. Test Specification Database
## 異なるデータソースをもとに統一した処理チェーンに沿ってデータベースでデータを処理する
異なるデータソースからデータを統一し、妥当性確認を目的としてデータをまとめる方法は？  
PEGASUS データベース：異なるデータソースの標準ストレージと標準処理のプロトタイプ。論理シナリオとパラメタ空間を導出する。

## 処理チェーンがデータベースの鍵
入力データから論理シナリオを作るためにパラメタ空間の抽出に必要な処理に必要なことは何か？  

* 処理チェーンでは、データ品質が違う異なるデータソースを扱う。
* 入力データは、通常TTCのような連続値。
* 連続的指標を論理シナリオに分解する。指標データシナリオを作成する。
* 指標データシナリオに向けてシナリオパラメタを導出する。各論理シナリオに対して、パラメタ空間を一つ張る。
* データベースによって、柔軟性がありつつ統一の処理チェーンの中で効率的に大量のデータを処理することができるようになる。



















